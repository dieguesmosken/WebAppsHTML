<!DOCTYPE html>
<html>
<head>
    <title>Estatísticas do Spotify</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta charset="utf-8">
    <!-- escrito por matheus mosken diegues -->
</head>
<body>
    <h1>Estatísticas do Spotify</h1>
    <div id="stats-container">
        <h2>Artistas Mais Ouvidos</h2>
        <ul id="top-artists"></ul>

        <h2>Músicas Mais Ouvidas</h2>
        <ul id="top-tracks"></ul>
    </div>

    <script src="script.js"></script>
    <script>
var client_id = 'CLIENT_ID';
var redirect_uri = 'http://localhost:8888/callback';

var app = express();

app.get('/login', function(req, res) {

  var state = generateRandomString(16);
  var scope = 'user-read-private user-read-email';

  res.redirect('https://accounts.spotify.com/authorize?' +
    querystring.stringify({
      response_type: 'code',
      client_id: client_id,
      scope: scope,
      redirect_uri: redirect_uri,
      state: state
    }));
});
        
       /* 
        // Authorization token that must have been created previously. See : https://developer.spotify.com/documentation/web-api/concepts/authorization
const token = 'BQALGo393mzBejl4FG3K2gCIs1OD-Lu2OB8M8w5qsxDVW84n_CuBovfqp80FPCM-dgd1ZgsAdlnEO1zthB9hgGUGlTPuiLziuRwYd-Bjmh9xSjZbaYEl87u-vIs-ywcUmc8Pq7K1kYYZDSAwMCPRD36TItd5gEiWjLZiahGFW2m07IeSNHSwgCPAz3saPCCZY2-0rgfXU_cyl67ReI3wD8AodBrW2j4RD25uhxPDobf8tevP9LjwkK9XqkocQImTm52aVRwPoKCn3105P4TA_B_EGwtK';
async function fetchWebApi(endpoint, method, body) {
  const res = await fetch(`https://api.spotify.com/${endpoint}`, {
    headers: {
      Authorization: `Bearer ${token}`,
    },
    method,
    body:JSON.stringify(body)
  });
  return await res.json();
}

async function getTopTracks(){
  // Endpoint reference : https://developer.spotify.com/documentation/web-api/reference/get-users-top-artists-and-tracks
  return (await fetchWebApi(
    'v1/me/top/tracks?time_range=short_term&limit=5', 'GET'
  )).items;
}

const topTracks = await getTopTracks();
console.log(
  topTracks?.map(
    ({name, artists}) =>
      `${name} by ${artists.map(artist => artist.name).join(', ')}`
  )
);
*/
</script>
</body>
</html>
